<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тест по ивриту с элементами математики (Pro)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
            background-color: #f4f4f4;
            color: #333;
        }
        .quiz-container {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            max-width: 800px;
            margin: 20px auto;
        }
        h1, h2 {
            color: #5a007f; /* Фиолетовый */
            text-align: center;
        }
        .text-section {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        .text-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        .hebrew-text {
            font-size: 1.2em;
            margin-bottom: 10px;
            direction: rtl;
            text-align: right;
            background-color: #eef;
            padding: 10px;
            border-radius: 5px;
        }
        .vocabulary {
            font-size: 0.9em;
            color: #555;
            margin-bottom: 15px;
            padding-left: 20px;
            border-left: 3px solid #ccc;
        }
        .vocabulary details summary {
            cursor: pointer;
            font-weight: bold;
            color: #007bff;
        }
        .question {
            margin-bottom: 15px;
        }
        .question p {
            margin-bottom: 5px;
            font-weight: bold;
        }
        .options label {
            display: block;
            margin-bottom: 5px;
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            transition: background-color 0.2s;
            border: 1px solid transparent;
        }
        .options label:hover {
            background-color: #f0f8ff; /* Light alice blue */
            border-color: #cce0ff;
        }
        .options input[type="radio"] {
            margin-right: 8px;
            vertical-align: middle;
        }
        .options input[type="radio"]:disabled + span {
             color: #666; /* Текст для заблокированных опций */
        }
        .feedback {
            font-size: 0.9em;
            font-weight: bold;
            margin-top: 5px;
            padding: 8px;
            border-radius: 4px;
            border-left-width: 4px;
            border-left-style: solid;
        }
        .correct {
            color: #155724; /* Dark green */
            background-color: #d4edda; /* Light green */
            border-left-color: #28a745; /* Green */
        }
        .incorrect {
            color: #721c24; /* Dark red */
            background-color: #f8d7da; /* Light red */
            border-left-color: #dc3545; /* Red */
        }
        .unanswered {
            color: #856404; /* Dark yellow/brown */
            background-color: #fff3cd; /* Light yellow */
            border-left-color: #ffc107; /* Yellow */
        }
        #results-container {
            margin-top: 30px;
            padding: 20px;
            background-color: #e9f5ff; /* Light blue */
            border: 1px solid #b3d7ff;
            border-radius: 8px;
            text-align: center;
        }
        #results-container h2 {
            color: #0056b3; /* Darker blue */
        }
        #results-container p#score-display {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 15px;
        }
        #detailed-answers ol {
            list-style-type: none;
            padding-left: 0;
            text-align: left;
        }
        #detailed-answers li {
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 4px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
        }
        .submit-button, .reset-button {
            display: block;
            width: auto;
            min-width: 220px;
            margin: 20px auto;
            padding: 12px 20px;
            font-size: 1.1em;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            text-align: center;
        }
        .submit-button {
            background-color: #007bff; /* Blue */
        }
        .submit-button:hover {
            background-color: #0056b3;
        }
        .reset-button {
            background-color: #6c757d; /* Gray */
            margin-top: 10px;
        }
        .reset-button:hover {
            background-color: #5a6268;
        }
    </style>
</head>
<body>

<div class="quiz-container">
    <h1>Тест по ивриту с элементами математики</h1>
    <p style="text-align: center;">За каждый правильный ответ начисляется 8 баллов.</p>

    <form id="quizForm">
        <!-- Текст 1 -->
        <div class="text-section">
            <h2>Текст 1: מסיבת יום הולדת</h2>
            <div class="hebrew-text">
                לִינָה חוֹגֶגֶת יוֹם הוּלֶדֶת. הִיא עַכְשָׁיו בַּת שְׁמוֹנֶה. הִיא מַזְמִינָה חֲמִשָּׁה חֲבֵרִים לַמְסִיבָּה שֶׁלָה. אִמָא שֶׁל לִינָה מְכִינָה עוּגָה גְדוֹלָה. לְכָל חָבֵר, לִינָה מְכִינָה שְׁתֵּי מַתָּנוֹת קְטַנוֹת. הִיא גַם קוֹנָה עֲשָׂרָה בָּלוֹנִים צִבְעוֹנִיִים.
            </div>
            <div class="vocabulary"><details><summary>Словарик:</summary></details></div>
            <div class="questions">
                <div class="question">
                    <p>1. בַּת כַּמָה לִינָה עַכְשָׁיו?</p>
                    <div class="options">
                        <label><input type="radio" name="q1" value="A"><span> А) 5</span></label>
                        <label><input type="radio" name="q1" value="B"><span> Б) 8</span></label>
                        <label><input type="radio" name="q1" value="C"><span> В) 10</span></label>
                        <label><input type="radio" name="q1" value="D"><span> Г) 2</span></label>
                    </div><div class="feedback" id="feedback-q1"></div>
                </div>
                <div class="question">
                    <p>2. כַּמָה מַתָּנוֹת סַךְ הַכֹּל לִינָה מְכִינָה לַחֲבֵרִים שֶׁלָה?</p>
                    <div class="options">
                        <label><input type="radio" name="q2" value="A"><span> А) 5</span></label>
                        <label><input type="radio" name="q2" value="B"><span> Б) 2</span></label>
                        <label><input type="radio" name="q2" value="C"><span> В) 10</span></label>
                        <label><input type="radio" name="q2" value="D"><span> Г) 7</span></label>
                    </div><div class="feedback" id="feedback-q2"></div>
                </div>
                <div class="question">
                    <p>3. כַּמָה אֲנָשִׁים יִהְיוּ בַּמְסִיבָּה, כּוֹלֵל לִינָה?</p>
                    <div class="options">
                        <label><input type="radio" name="q3" value="A"><span> А) 5</span></label>
                        <label><input type="radio" name="q3" value="B"><span> Б) 6</span></label>
                        <label><input type="radio" name="q3" value="C"><span> В) 8</span></label>
                        <label><input type="radio" name="q3" value="D"><span> Г) 10</span></label>
                    </div><div class="feedback" id="feedback-q3"></div>
                </div>
            </div>
        </div>

        <!-- Текст 2 -->
        <div class="text-section">
            <h2>Текст 2: טיול לתל אביב</h2>
            <div class="hebrew-text">
                מִשְׁפַּחַת כֹּהֵן נוֹסַעַת לְטִיּוּל בְּתֵל אָבִיב. בַּמִשְׁפָּחָה יֵשׁ אַרְבָּעָה אֲנָשִׁים: אַבָּא, אִמָא, וּשְׁנֵי יְלָדִים. הֵם נוֹסְעִים בָּרַכֶּבֶת. הַנְסִיעָה מִירוּשָׁלַיִם לְתֵל אָבִיב לוֹקַחַת שָׁעָה אַחַת. כַּרְטִיס לְאָדָם אֶחָד עוֹלֶה 25 שְׁקָלִים. הֵם רוֹצִים לִהְיוֹת בְּתֵל אָבִיב שָׁלוֹשׁ שָׁעוֹт.
            </div>
            <div class="vocabulary"><details><summary>Словарик:</summary></details></div>
            <div class="questions">
                <div class="question">
                    <p>4. כַּמָה אֲנָשִׁים יֵשׁ בְּמִשְׁפַּחַת כֹּהֵן?</p>
                    <div class="options">
                        <label><input type="radio" name="q4" value="A"><span> А) 2</span></label>
                        <label><input type="radio" name="q4" value="B"><span> Б) 3</span></label>
                        <label><input type="radio" name="q4" value="C"><span> В) 4</span></label>
                        <label><input type="radio" name="q4" value="D"><span> Г) 1</span></label>
                    </div><div class="feedback" id="feedback-q4"></div>
                </div>
                <div class="question">
                    <p>5. כַּמָה כֶּסֶף הַמִשְׁפָּחָה צְרִיכָה לְשַׁלֵם עֲבוּר כָּל הַכַּרְטִיסִים לָרַכֶּבֶת?</p>
                    <div class="options">
                        <label><input type="radio" name="q5" value="A"><span> А) 25 שקלים</span></label>
                        <label><input type="radio" name="q5" value="B"><span> Б) 50 שקלים</span></label>
                        <label><input type="radio" name="q5" value="C"><span> В) 75 שקלים</span></label>
                        <label><input type="radio" name="q5" value="D"><span> Г) 100 שקלים</span></label>
                    </div><div class="feedback" id="feedback-q5"></div>
                </div>
                 <div class="question">
                    <p>6. כַּמָה זְמַן לוֹקַחַת הַנְסִיעָה בָּרַכֶּבֶת מִירוּשָׁלַיִם לְתֵל אָבִיב?</p>
                    <div class="options">
                        <label><input type="radio" name="q6" value="A"><span> А) שעה אחת (Один час)</span></label>
                        <label><input type="radio" name="q6" value="B"><span> Б) שעתיים (Два часа)</span></label>
                        <label><input type="radio" name="q6" value="C"><span> В) שלוש שעות (Три часа)</span></label>
                        <label><input type="radio" name="q6" value="D"><span> Г) ארבע שעות (Четыре часа)</span></label>
                    </div><div class="feedback" id="feedback-q6"></div>
                </div>
            </div>
        </div>

        <!-- Текст 3 -->
        <div class="text-section">
            <h2>Текст 3: סדר יום בבוקר</h2>
            <div class="hebrew-text">
                 דָוִד קָם בְּשָׁעָה שֶׁבַע בַּבֹּקֶר. הוּא מִתְלַבֵּשׁ וְהוֹלֵךְ לַמִטְבָּח. לַאֲרוּחַת בֹּקֶר הוּא אוֹכֵל שְׁתֵּי פְּרוּסוֹת לֶחֶם עִם גְבִינָה וְשׁוֹתֶה כּוֹס אַחַת שֶׁל מִיץ תַּפּוּזִים. בְּשָׁעָה שְׁמוֹנֶה הוּא הוֹלֵךְ לְבֵית הַסֵפֶר. הַיּוֹם יֵשׁ לוֹ חֲמִשָּׁה שִׁיעוּרִים. הַשִׁיעוּר הָרִאשׁוֹן הוּא מָתֶמָטִיקָה.
            </div>
            <div class="vocabulary"><details><summary>Словарик:</summary></details></div>
            <div class="questions">
                <div class="question">
                    <p>7. בְּאֵיזוֹ שָׁעָה דָוִד קָם בַּבֹּקֶר?</p>
                    <div class="options">
                        <label><input type="radio" name="q7" value="A"><span> А) שש (Шеш - Шесть)</span></label>
                        <label><input type="radio" name="q7" value="B"><span> Б) שבע (Шева - Семь)</span></label>
                        <label><input type="radio" name="q7" value="C"><span> В) שמונה (Шмонэ - Восемь)</span></label>
                        <label><input type="radio" name="q7" value="D"><span> Г) תשע (Теша - Девять)</span></label>
                    </div><div class="feedback" id="feedback-q7"></div>
                </div>
                <div class="question">
                    <p>8. כַּמָה פְּרִיטֵי מָזוֹן (לֶחֶם וּמַשְׁקֶה) דָוִד אוֹכֵל וְשׁוֹתֶה בַּאֲרוּחַת הַבֹּקֶר?</p>
                    <div class="options">
                        <label><input type="radio" name="q8" value="A"><span> А) 1</span></label>
                        <label><input type="radio" name="q8" value="B"><span> Б) 2</span></label>
                        <label><input type="radio" name="q8" value="C"><span> В) 3</span></label>
                        <label><input type="radio" name="q8" value="D"><span> Г) 4</span></label>
                    </div><div class="feedback" id="feedback-q8"></div>
                </div>
                <div class="question">
                    <p>9. כַּמָה שִׁיעוּרִים יֵשׁ לְדָוִד הַיּוֹם?</p>
                    <div class="options">
                        <label><input type="radio" name="q9" value="A"><span> А) 3</span></label>
                        <label><input type="radio" name="q9" value="B"><span> Б) 4</span></label>
                        <label><input type="radio" name="q9" value="C"><span> В) 5</span></label>
                        <label><input type="radio" name="q9" value="D"><span> Г) 1</span></label>
                    </div><div class="feedback" id="feedback-q9"></div>
                </div>
            </div>
        </div>

        <!-- Текст 4 -->
        <div class="text-section">
            <h2>Текст 4: לימוד עברית</h2>
            <div class="hebrew-text">
                רִינָה לוֹמֶדֶת עִבְרִית בָּאוּלְפָּן. כָּל יוֹם הִיא לוֹמֶדֶת עֶשֶׂר מִילִים חֲדָשׁוֹת. הִיא לוֹמֶדֶת חֲמִשָּׁה יָמִים בְּשָׁבוּעַ. בַּסֵפֶר שֶׁלָה יֵשׁ מֵאָה עַמוּדִים. הִיא כְּבָר קָרְאָה עֶשְׂרִים עַמוּדִים מֵהַסֵפֶר. הִיא מְאוֹד אוֹהֶבֶת לִלְמוֹד.
            </div>
            <div class="vocabulary"><details><summary>Словарик:</summary></details></div>
            <div class="questions">
                <div class="question">
                    <p>10. כַּמָה מִילִים חֲדָשׁוֹת רִינָה לוֹמֶדֶת כָּל יוֹם?</p>
                    <div class="options">
                        <label><input type="radio" name="q10" value="A"><span> А) 5</span></label>
                        <label><input type="radio" name="q10" value="B"><span> Б) 10</span></label>
                        <label><input type="radio" name="q10" value="C"><span> В) 20</span></label>
                        <label><input type="radio" name="q10" value="D"><span> Г) 100</span></label>
                    </div><div class="feedback" id="feedback-q10"></div>
                </div>
                <div class="question">
                    <p>11. כַּמָה מִילִים חֲדָשׁוֹת רִינָה לוֹמֶדֶת בְּשָׁבוּעַ אֶחָד (אִם הִיא לוֹמֶדֶת 5 יָמִים)?</p>
                    <div class="options">
                        <label><input type="radio" name="q11" value="A"><span> А) 10</span></label>
                        <label><input type="radio" name="q11" value="B"><span> Б) 25</span></label>
                        <label><input type="radio" name="q11" value="C"><span> В) 50</span></label>
                        <label><input type="radio" name="q11" value="D"><span> Г) 100</span></label>
                    </div><div class="feedback" id="feedback-q11"></div>
                </div>
                <div class="question">
                    <p>12. כַּמָה עַמוּדִים נִשְׁאֲרוּ לְרִינָה לִקְרוֹא בַּסֵפֶר?</p>
                    <div class="options">
                        <label><input type="radio" name="q12" value="A"><span> А) 20</span></label>
                        <label><input type="radio" name="q12" value="B"><span> Б) 80</span></label>
                        <label><input type="radio" name="q12" value="C"><span> В) 100</span></label>
                        <label><input type="radio" name="q12" value="D"><span> Г) 120</span></label>
                    </div><div class="feedback" id="feedback-q12"></div>
                </div>
            </div>
        </div>

        <!-- Текст 5 -->
        <div class="text-section">
            <h2>Текст 5: בגן החיות</h2>
            <div class="hebrew-text">
                 יוֹאָב וְאָחוֹת שֶׁלוֹ, תָמָר, הוֹלְכִים לְגַן הַחַיּוֹת. הֵם רוֹאִים שְׁלוֹשָׁה אַרְיָות, שְׁנֵי פִּילִים, וַחֲמִשָּׁה קוֹפִים. כָּל אַרְיֵה אוֹכֵל שְׁנֵי קִילוֹגְרָם בָּשָׂר בְּיוֹם. תָמָר קוֹנָה גְלִידָה אַחַת שֶׁעוֹלָה שִׁבְעָה שְׁקָלִים. יוֹאָב קוֹנֶה שְׁתֵּי בַּקְבּוּקֵי מַיִם, כָּל אֶחָד עוֹלֶה 4 שְׁקָלִים.
            </div>
            <div class="vocabulary"><details><summary>Словарик:</summary></details></div>
            <div class="questions">
                <div class="question">
                    <p>13. כַּמָה פִּילִים וְקוֹפִים יַחַד רוֹאִים יוֹאָב וְתָמָר?</p>
                    <div class="options">
                        <label><input type="radio" name="q13" value="A"><span> А) 2</span></label>
                        <label><input type="radio" name="q13" value="B"><span> Б) 5</span></label>
                        <label><input type="radio" name="q13" value="C"><span> В) 7</span></label>
                        <label><input type="radio" name="q13" value="D"><span> Г) 10</span></label>
                    </div><div class="feedback" id="feedback-q13"></div>
                </div>
                <div class="question">
                    <p>14. כַּמָה קִילוֹגְרָם בָּשָׂר כָּל הָאַרְיָות אוֹכְלִים יַחַד בְּיוֹם אֶחָד?</p>
                    <div class="options">
                        <label><input type="radio" name="q14" value="A"><span> А) 2</span></label>
                        <label><input type="radio" name="q14" value="B"><span> Б) 3</span></label>
                        <label><input type="radio" name="q14" value="C"><span> В) 5</span></label>
                        <label><input type="radio" name="q14" value="D"><span> Г) 6</span></label>
                    </div><div class="feedback" id="feedback-q14"></div>
                </div>
                <div class="question">
                    <p>15. כַּמָה כֶּסֶף יוֹאָב מְשַׁלֵם עַל הַמַיִם?</p>
                    <div class="options">
                        <label><input type="radio" name="q15" value="A"><span> А) 4 שקלים</span></label>
                        <label><input type="radio" name="q15" value="B"><span> Б) 7 שקלים</span></label>
                        <label><input type="radio" name="q15" value="C"><span> В) 8 שקלים</span></label>
                        <label><input type="radio" name="q15" value="D"><span> Г) 11 שקלים</span></label>
                    </div><div class="feedback" id="feedback-q15"></div>
                </div>
            </div>
        </div>
        
        <button type="button" class="submit-button" onclick="submitQuiz()">Проверить результаты</button>
        <button type="button" class="reset-button" onclick="resetFullQuiz()" style="display: none;">Начать тест заново (полный сброс)</button>
    </form>

    <div id="results-container" style="display: none;">
        <h2>Ваши результаты:</h2>
        <p id="score-display"></p>
        <div id="detailed-answers"></div>
    </div>
</div>

<script>
    const correctAnswers = {
        q1: 'B', q2: 'C', q3: 'B',
        q4: 'C', q5: 'D', q6: 'A',
        q7: 'B', q8: 'C', q9: 'C',
        q10: 'B', q11: 'C', q12: 'B',
        q13: 'C', q14: 'D', q15: 'C'
    };

    const answerDisplayTexts = { // Тексты вариантов ответа для отображения
        q1: {A: "А) 5", B: "Б) 8", C: "В) 10", D: "Г) 2"},
        q2: {A: "А) 5", B: "Б) 2", C: "В) 10", D: "Г) 7", explanation: "(5 друзей * 2 подарка/другу = 10 подарков)"},
        q3: {A: "А) 5", B: "Б) 6", C: "В) 8", D: "Г) 10", explanation: "(Лина + 5 друзей = 6 человек)"},
        q4: {A: "А) 2", B: "Б) 3", C: "В) 4", D: "Г) 1"},
        q5: {A: "А) 25 שקלים", B: "Б) 50 שקלים", C: "В) 75 שקלים", D: "Г) 100 שקלים", explanation: "(4 человека * 25 шекелей/человека = 100 шекелей)"},
        q6: {A: "А) שעה אחת (Один час)", B: "Б) שעתיים (Два часа)", C: "В) שלוש שעות (Три часа)", D: "Г) ארבע שעות (Четыре часа)"},
        q7: {A: "А) שש (Шеш - Шесть)", B: "Б) שבע (Семь)", C: "В) שמונה (Шмонэ - Восемь)", D: "Г) תשע (Теша - Девять)"},
        q8: {A: "А) 1", B: "Б) 2", C: "В) 3", D: "Г) 4", explanation: "(2 ломтика хлеба + 1 стакан сока = 3 предмета)"},
        q9: {A: "А) 3", B: "Б) 4", C: "В) 5", D: "Г) 1"},
        q10: {A: "А) 5", B: "Б) 10", C: "В) 20", D: "Г) 100"},
        q11: {A: "А) 10", B: "Б) 25", C: "В) 50", D: "Г) 100", explanation: "(10 слов/день * 5 дней = 50 слов)"},
        q12: {A: "А) 20", B: "Б) 80", C: "В) 100", D: "Г) 120", explanation: "(100 страниц - 20 страниц = 80 страниц)"},
        q13: {A: "А) 2", B: "Б) 5", C: "В) 7", D: "Г) 10", explanation: "(2 слона + 5 обезьян = 7)"},
        q14: {A: "А) 2", B: "Б) 3", C: "В) 5", D: "Г) 6", explanation: "(3 льва * 2 кг/льва = 6 кг)"},
        q15: {A: "А) 4 שקלים", B: "Б) 7 שקלים", C: "В) 8 שקלים", D: "Г) 11 שקלים", explanation: "(2 бутылки * 4 шекеля/бутылку = 8 шекелей)"}
    };

    const pointsPerQuestion = 8;
    const totalQuestions = Object.keys(correctAnswers).length;
    const secretWordThreshold = 100;
    const secretWord = "потолок";

    let correctlyAnsweredInSession = {}; // { q1: true, q2: false, ... } для отслеживания правильных ответов в текущей сессии

    function submitQuiz() {
        let currentTotalScore = 0;
        const form = document.getElementById('quizForm');
        const resultsContainer = document.getElementById('results-container');
        const scoreDisplay = document.getElementById('score-display');
        const detailedAnswersDiv = document.getElementById('detailed-answers');
        const submitButton = document.querySelector('.submit-button');
        const resetButton = document.querySelector('.reset-button');

        let reportHtml = ""; // Будет HTML для детального отчета

        for (let i = 1; i <= totalQuestions; i++) {
            const questionName = 'q' + i;
            const radioGroup = form.elements[questionName];
            const feedbackEl = document.getElementById('feedback-' + questionName);
            
            // Если вопрос уже был правильно отвечен и заблокирован
            if (correctlyAnsweredInSession[questionName]) {
                currentTotalScore += pointsPerQuestion;
                // Фидбек и блокировка уже установлены, ничего не меняем для них
                continue; 
            }

            // Для активных (незаблокированных) вопросов
            const userAnswer = radioGroup ? radioGroup.value : "";

            if (userAnswer) {
                if (userAnswer === correctAnswers[questionName]) {
                    currentTotalScore += pointsPerQuestion;
                    correctlyAnsweredInSession[questionName] = true; // Запомнить как правильно отвеченный
                    feedbackEl.textContent = 'Верно!';
                    feedbackEl.className = 'feedback correct';
                } else {
                    correctlyAnsweredInSession[questionName] = false; // Отметить как неверно отвеченный в этой попытке
                    feedbackEl.textContent = 'Неверно.';
                    feedbackEl.className = 'feedback incorrect';
                }
            } else {
                correctlyAnsweredInSession[questionName] = false; // Отметить как не отвеченный в этой попытке
                feedbackEl.textContent = 'Нет ответа.';
                feedbackEl.className = 'feedback unanswered';
            }
        }

        scoreDisplay.textContent = `Вы набрали: ${currentTotalScore} из ${totalQuestions * pointsPerQuestion} баллов.`;
        resultsContainer.style.display = 'block';

        if (currentTotalScore > secretWordThreshold) {
            scoreDisplay.innerHTML += `<br><strong style="color:green; font-size:1.2em;">Поздравляем! Ваше секретное слово: ${secretWord}</strong>`;
            
            reportHtml = '<h3>Детализация ответов (победа!):</h3><ol>';
            for (let i = 1; i <= totalQuestions; i++) {
                const qName = 'q' + i;
                const radios = form.elements[qName];
                let userAnswerVal = "";
                if (radios) { // Ищем выбранный ответ, если вопрос был активен
                     for(const radio of radios) { if(radio.checked) userAnswerVal = radio.value; }
                }
                
                reportHtml += `<li>Вопрос ${i}: `;
                if (correctlyAnsweredInSession[qName]) {
                     reportHtml += `<span class="correct">Верно.</span> Ваш ответ: "${answerDisplayTexts[qName][correctAnswers[qName]]}".`;
                     if (answerDisplayTexts[qName].explanation) reportHtml += ` ${answerDisplayTexts[qName].explanation}`;
                } else { // Для неверных теперь показываем правильный
                    reportHtml += `<span class="incorrect">Неверно.</span> `;
                    if(userAnswerVal && answerDisplayTexts[qName][userAnswerVal]) { // Если был дан ответ
                        reportHtml += `Ваш ответ был: "${answerDisplayTexts[qName][userAnswerVal]}". `;
                    }
                    reportHtml += `Правильный ответ: "${answerDisplayTexts[qName][correctAnswers[qName]]}".`;
                    if (answerDisplayTexts[qName].explanation) reportHtml += ` ${answerDisplayTexts[qName].explanation}`;
                }
                reportHtml += `</li>`;
            }
            reportHtml += '</ol>';
            detailedAnswersDiv.innerHTML = reportHtml;

            // Блокируем все вопросы окончательно
            for (let i = 1; i <= totalQuestions; i++) {
                const qName = 'q' + i;
                const radios = form.elements[qName];
                if (radios) {
                    for (const radio of radios) radio.disabled = true;
                }
            }
            submitButton.style.display = 'none';
            resetButton.style.display = 'block'; // Показать кнопку полного сброса

        } else { // currentTotalScore <= secretWordThreshold
            scoreDisplay.innerHTML += `<br><span style="color:red;">Попробуйте еще раз улучшить результат!</span>`;
            
            reportHtml = '<h3>Результаты текущей попытки:</h3><ol>';
             for (let i = 1; i <= totalQuestions; i++) {
                const qName = 'q' + i;
                const radios = form.elements[qName];
                let userAnswerVal = "";
                 if (radios && !radios[0].disabled) { // Только для активных вопросов
                     for(const radio of radios) { if(radio.checked) userAnswerVal = radio.value; }
                 }

                reportHtml += `<li>Вопрос ${i}: `;
                if (correctlyAnsweredInSession[qName]) {
                     reportHtml += `<span class="correct">Верно.</span> Ваш ответ: "${answerDisplayTexts[qName][correctAnswers[qName]]}".`;
                     // Можно добавить объяснение, если хотите, даже при неудаче, для правильных
                     // if (answerDisplayTexts[qName].explanation) reportHtml += ` ${answerDisplayTexts[qName].explanation}`;
                } else if (userAnswerVal) { // Неверный ответ, правильный не показываем
                    reportHtml += `<span class="incorrect">Неверно.</span> Ваш ответ был: "${answerDisplayTexts[qName][userAnswerVal]}".`;
                } else if (!radios || !radios[0].disabled) { // Не отвечен (и не заблокирован)
                    reportHtml += `<span class="unanswered">Нет ответа.</span>`;
                } else { // Заблокирован и правильно отвечен ранее
                     reportHtml += `<span class="correct">Верно (засчитано ранее).</span>`;
                }
                reportHtml += `</li>`;
            }
            reportHtml += '</ol>';
            detailedAnswersDiv.innerHTML = reportHtml;


            // Обновляем состояние формы для следующей попытки
            for (let i = 1; i <= totalQuestions; i++) {
                const qName = 'q' + i;
                const radios = form.elements[qName];
                if (!radios) continue;

                if (correctlyAnsweredInSession[qName]) { // Если отвечен правильно в этой сессии
                    for (const radio of radios) {
                        radio.disabled = true;
                        // Убедимся, что правильный ответ выбран
                        if (radio.value === correctAnswers[qName]) radio.checked = true;
                    }
                } else { // Если неверно или не отвечен в этой сессии
                    for (const radio of radios) {
                        radio.disabled = false;
                        radio.checked = false; // Сбрасываем неверный выбор
                    }
                }
            }
            submitButton.textContent = "Проверить исправленные ответы";
            submitButton.style.display = 'block';
            resetButton.style.display = 'block'; // Показать кнопку полного сброса
        }
    }

    function resetFullQuiz() {
        correctlyAnsweredInSession = {};
        const form = document.getElementById('quizForm');
        form.reset(); 

        for (let i = 1; i <= totalQuestions; i++) {
            const questionName = 'q' + i;
            const radioGroup = form.elements[questionName];
            const feedbackEl = document.getElementById('feedback-' + questionName);
            feedbackEl.textContent = '';
            feedbackEl.className = 'feedback';
            if (radioGroup) {
                for (const radio of radioGroup) {
                    radio.disabled = false;
                }
            }
        }
        document.getElementById('results-container').style.display = 'none';
        const submitBtn = document.querySelector('.submit-button');
        submitBtn.textContent = "Проверить результаты";
        submitBtn.style.display = 'block';
        document.querySelector('.reset-button').style.display = 'none';
    }

    document.addEventListener('DOMContentLoaded', () => {
        const vocabContents = {
            text1: `<ul><li>חוֹגֶגֶת (хоге́гет) - празднует (ж.р.)</li><li>עַכְשָׁיו (ахша́в) - сейчас</li><li>בַּת שְׁמוֹנֶה (бат шмо́нэ) - восемь лет (девочке)</li><li>מַזְמִינָה (мазмина́) - приглашает (ж.р.)</li><li>חֲמִשָּׁה חֲבֵרִים (хамиша́ хавери́м) - пять друзей</li><li>מְכִינָה (мэхина́) - готовит, подготавливает (ж.р.)</li><li>עוּגָה גְדוֹלָה (уга́ гдола́) - большой торт</li><li>לְכָל חָבֵר (лэ-холь хаве́р) - каждому другу</li><li>שְׁתֵּי מַתָּנוֹת קְטַנוֹת (штэй матано́т ктано́т) - два маленьких подарка</li><li>עֲשָׂרָה בָּלוֹנִים צִבְעוֹנִיִים (асара́ балони́м цив'онии́м) - десять разноцветных шариков</li></ul>`,
            text2: `<ul><li>מִשְׁפַּחַת כֹּהֵן (мишпа́хат Ко́hэн) - семья Коэн</li><li>נוֹסַעַת (носа́ат) - едет (семья - ж.р. ед.ч.)</li><li>אַרְבָּעָה אֲנָשִׁים (арбаа́ анаши́м) - четыре человека</li><li>שְׁנֵי יְלָדִים (шнэй елади́м) - двое детей</li><li>בָּרַכֶּבֶת (ба-раке́вет) - на поезде</li><li>הַנְסִיעָה (hа-нэсиа́) - поездка</li><li>לוֹקַחַת (лока́хат) - занимает (время, ж.р.)</li><li>שָׁעָה אַחַת (шаа́ аха́т) - один час</li><li>כַּרְטִיס (карти́с) - билет</li><li>אָדָם אֶחָד (ада́м эха́д) - один человек</li><li>שָׁלוֹשׁ שָׁעוֹת (шало́ш шао́т) - три часа</li></ul>`,
            text3: `<ul><li>קָם (кам) - встает (м.р.)</li><li>בְּשָׁעָה שֶׁבַע (бэ-шаа́ шэ́ва) - в семь часов</li><li>מִתְלַבֵּשׁ (митлабе́ш) - одевается</li><li>לַמִטְבָּח (ла-митба́х) - на кухню</li><li>אֲרוּחַת בֹּקֶר (аруха́т бо́кер) - завтрак</li><li>שְׁתֵּי פְּרוּסוֹת לֶחֶם (штэй прусо́т ле́хем) - два ломтика хлеба</li><li>גְבִינָה (гвина́) - сыр</li><li>כּוֹס אַחַת (кос аха́т) - один стакан</li><li>מִיץ תַּפּוּזִים (миц тапузи́м) - апельсиновый сок</li><li>חֲמִשָּׁה שִׁיעוּרִים (хамиша́ шиури́м) - пять уроков</li><li>הַשִׁיעוּר הָרִאשׁוֹן (hа-шиу́р hа-ришо́н) - первый урок</li><li>מָתֶמָטִיקָה (матема́тика) - математика</li></ul>`,
            text4: `<ul><li>לוֹמֶדֶת (ломе́дет) - учит (ж.р.)</li><li>בָּאוּלְפָּן (ба-ульпа́н) - в ульпане (школе иврита)</li><li>כָּל יוֹם (коль йом) - каждый день</li><li>עֶשֶׂר מִילִים חֲדָשׁוֹת (э́сэр мили́м хадашо́т) - десять новых слов</li><li>חֲמִשָּׁה יָמִים בְּשָׁבוּעַ (хамиша́ ями́м бэ-шаву́а) - пять дней в неделю</li><li>בַּסֵפֶר שֶׁלָה (ба-се́фер шэла́) - в ее книге</li><li>מֵאָה עַמוּדִים (мэ́а амуди́м) - сто страниц</li><li>כְּבָר קָרְאָה (квар кар'а́) - уже прочитала</li><li>עֶשְׂרִים עַמוּדִים (эсри́м амуди́м) - двадцать страниц</li><li>מְאוֹד אוֹהֶבֶת (мэо́д оhэ́вет) - очень любит</li></ul>`,
            text5: `<ul><li>יוֹאָב (Йоа́в) - Йоав (имя)</li><li>אָחוֹת שֶׁלוֹ (ахо́т шэло́) - его сестра</li><li>תָמָר (Тама́р) - Тамар (имя)</li><li>הוֹלְכִים (hольхи́м) - идут (мн.ч.)</li><li>רוֹאִים (ро'и́м) - видят (мн.ч.)</li><li>שְׁלוֹשָׁה אַרְיָות (шлоша́ арьайо́т) - три льва</li><li>שְׁנֵי פִּילִים (шнэй пили́м) - два слона</li><li>חֲמִשָּׁה קוֹפִים (хамиша́ кофи́м) - пять обезьян</li><li>כָּל אַרְיֵה (коль арье́) - каждый лев</li><li>קִילוֹגְרָם בָּשָׂר (килогра́м баса́р) - килограмм мяса</li><li>בְּיוֹם (бэ-йом) - в день</li><li>גְלִידָה אַחַת (глида́ аха́т) - одно мороженое</li><li>שִׁבְעָה שְׁקָלִים (шив'а́ шкали́м) - семь шекелей</li><li>שְׁתֵּי בַּקְבּוּקֵי מַיִם (штэй бакбукэ́й ма́им) - две бутылки воды</li></ul>`
        };

        const textSections = document.querySelectorAll('.text-section');
        textSections.forEach((section, index) => {
            const vocabDetails = section.querySelector('.vocabulary details');
            if (vocabDetails) {
                const summary = vocabDetails.querySelector('summary');
                const contentKey = 'text' + (index + 1);
                if (summary && vocabContents[contentKey]) {
                     summary.insertAdjacentHTML('afterend', vocabContents[contentKey]);
                } else if (vocabContents[contentKey]) {
                    vocabDetails.innerHTML += vocabContents[contentKey];
                }
            }
        });
        document.querySelector('.reset-button').style.display = 'none'; // Сначала скрыть кнопку сброса
    });
</script>

</body>
</html>